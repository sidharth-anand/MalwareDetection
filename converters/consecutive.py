import math

import numpy as np

from core.config import DatasetConfig
from core.utils import DatasetUtils

from datasets.msbig import MSBig

class Consecutive(MSBig):
    OUTPUT_CHANNELS = 3

    def __init__(self, path: str, config: DatasetConfig, utils: DatasetUtils) -> None:
        super().__init__(path, MSBig.Type.BYTES, config, utils)

    def _convert_to_image(self, file: str) -> np.array:
        file_data = super()._get_byte_data(file)

        width = 47 * 15
        height = math.ceil(len(file_data) / width / 3)

        image = np.array(file_data + [0] * (height * width * 3 - len(file_data)), dtype=np.uint8).reshape((height, width, 3))
        return image