import os

import cv2
import numpy as np

from core.config import DatasetConfig
from core.utils import DatasetUtils

from datasets.dumpware import Dumpware

class DumpwareConverter(Dumpware):
    OUTPUT_CHANNELS = 3
    CONVERT_OFFLINE = True

    def __init__(self, path: str, config: DatasetConfig, utils: DatasetUtils) -> None:
        super().__init__(path, config, utils)

    def _convert_to_image(self, file: str) -> np.array:
        pass

    def _load_converted_image(self, file: str) -> np.ndarray:
        file = file.decode()

        if not os.path.exists(file):
            return np.zeros((256, 256, 3), dtype=np.uint8)

        image = cv2.imread(file)
        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
        image = np.array(image)

        return image