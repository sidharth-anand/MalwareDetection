import typing

import tensorflow as tf

class Model(tf.keras.Model):
    def __init__() -> None:
        super().__init__()

    def callbacks(self, log_path: str, checkpoint_path: str) -> typing.List[tf.keras.callbacks.Callback]:
        return [
            tf.keras.callbacks.TensorBoard(log_dir=log_path, histogram_freq=1, write_graph=True),
            tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path, save_weights_only=False, save_best_only=False, verbose=1)
        ]

    def optimizer(self) -> tf.keras.optimizers.Optimizer:
        return tf.keras.optimizers.Adam()

    def loss(self) -> tf.keras.losses.Loss:
        return tf.keras.losses.CategoricalCrossEntropy()

    def metrics(self) -> typing.List[tf.keras.metrics.Metric]:
        return [
            tf.keras.metrics.CategoricalAccuracy(),
            tf.keras.metrics.CategoricalCrossentropy(),
            tf.keras.metrics.Precision(),
            tf.keras.metrics.Recall(),
        ]